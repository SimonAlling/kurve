<!DOCTYPE html>

<html lang="en">

<head>

    <title>Achtung, die Kurve!</title>

    <meta charset="UTF-8" />
    <meta name="author" content="Simon Alling" />
    <meta name="description" content="A clone of the classic DOS game from 1995 that runs in the browser." />
    <meta name="keywords" content="Achtung, Kurve, Zatacka, KONEC, HRY, HTML, JavaScript, DOS" />

    <meta property="og:url"                content="http://kurve.se" />
    <meta property="og:title"              content="Achtung, die Kurve!" />
    <meta property="og:description"        content="A clone of the classic DOS game from 1995 that runs in the browser." />
    <meta property="og:image"              content="http://kurve.se/resources/kurve-share.png" />

    <link rel="stylesheet" href="css/Zatacka.css" />
    <link rel="apple-touch-icon" sizes="57x57" href="resources/icon/apple-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="60x60" href="resources/icon/apple-icon-60x60.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="resources/icon/apple-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="resources/icon/apple-icon-76x76.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="resources/icon/apple-icon-114x114.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="resources/icon/apple-icon-120x120.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="resources/icon/apple-icon-144x144.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="resources/icon/apple-icon-152x152.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="resources/icon/apple-icon-180x180.png" />
    <link rel="icon" type="image/png" sizes="192x192"  href="resources/icon/android-icon-192x192.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="resources/icon/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="96x96" href="resources/icon/favicon-96x96.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="resources/icon/favicon-16x16.png" />
    <link rel="manifest" href="manifest.json" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="msapplication-TileImage" content="resources/icon/ms-icon-144x144.png" />
    <meta name="theme-color" content="#ffffff" />

</head>

<body id="ZATACKA" class="body">

    <h1>Achtung, die Kurve!</h1>
    <div id="fatalError_UA" class="fatalError">
        <div>
            <p>Your browser is not supported.</p>
            <p class="fatalErrorExtraInfo">Please use <a href="https://google.com/chrome/" title="Google Chrome">Chrome&nbsp;49+</a>, <a href="https://getfirefox.com" title="Mozilla Firefox">Firefox&nbsp;45+</a>, or another modern browser.</p>
        </div>
    </div>
    <div id="wrapper">
        <aside id="left" class="canvasHeight"></aside>
        <div id="border4" class="border">
        <div id="border3" class="border">
        <div id="border2" class="border">
        <div id="border1" class="border">
            <canvas id="canvas_main" width="559" height="480"></canvas>
            <canvas id="canvas_overlay"  width="559" height="480" class="overlay"></canvas>
            <div id="lobby" class="flex overlay">
                <ul id="controls">
                    <li>
                        <div class="red controls"></div>
                        <div class="red ready"></div>
                    </li>
                    <li>
                        <div class="yellow controls"></div>
                        <div class="yellow ready"></div>
                    </li>
                    <li>
                        <div class="orange controls"></div>
                        <div class="orange ready"></div>
                    </li>
                    <li>
                        <div class="green controls"></div>
                        <div class="green ready"></div>
                    </li>
                    <li>
                        <div class="pink controls"></div>
                        <div class="pink ready"></div>
                    </li>
                    <li>
                        <div class="blue controls"></div>
                        <div class="blue ready"></div>
                    </li>
                </ul>
                <a id="button-show-settings" class="corner icon-button" title="Settings"></a>
            </div>
            <div id="KONEC_HRY" class="hidden overlay">
                <ul id="results">
                    <li class="red digits"></li>
                    <li class="yellow digits"></li>
                    <li class="orange digits"></li>
                    <li class="green digits"></li>
                    <li class="pink digits"></li>
                    <li class="blue digits"></li>
                </ul>
            </div>
            <div id="messages" class="overlay"></div>
            <div id="settings" class="hidden overlay">
                <a id="button-hide-settings" class="corner icon-button" title="Close"></a>
                <form id="settings-form"></form>
            </div>
            <div id="dialogs" class="hidden overlay"></div>
        </div>
        </div>
        </div>
        </div>
        <aside id="scoreboard" class="canvasHeight">
            <!-- The empty divs ensure preloading of the digits images. -->
            <div class="red digits"><div></div></div>
            <div class="yellow digits"><div></div></div>
            <div class="orange digits"><div></div></div>
            <div class="green digits"><div></div></div>
            <div class="pink digits"><div></div></div>
            <div class="blue digits"><div></div></div>
        </aside>
    </div>

    <script src="./js/kurve.min.js"></script>
    <script type="module">
    import { Renderer } from "./src/js/Renderer.js"

    const renderer = new Renderer(canvas_main, canvas_overlay)
    const app = Elm.Main.init()

    app.ports.render.subscribe(data => {
        renderer.drawSquare(data.position.leftEdge, data.position.topEdge, data.thickness, data.color)
    })

    app.ports.clear.subscribe(data => {
        renderer.clearRectangle(0, 0, data.width, data.height)
    })

    app.ports.renderOverlay.subscribe(data => {
        renderer.drawSquare_overlay(data.position.leftEdge, data.position.topEdge, data.thickness, data.color)
    })

    app.ports.clearOverlay.subscribe(data => {
        renderer.clearRectangle_overlay(0, 0, data.width, data.height)
    })

    document.addEventListener("keydown", event => {
        const isDeveloperCommand = (
            ["F5", "F12"].includes(event.key)
            ||
            (event.ctrlKey && event.key === "r") // Ctrl + R
            ||
            (event.metaKey && event.key === "r") // Cmd + R on macOS ðŸ‘€
        )
        if (!isDeveloperCommand) {
            event.preventDefault()
        }
        if (!event.repeat) {
            app.ports.onKeydown.send(event.key)
        }
    })
    document.addEventListener("keyup", () => {
        // Traditionally we never prevented default on keyup.
        app.ports.onKeyup.send(event.key)
    })
    </script>

</body>

</html>
